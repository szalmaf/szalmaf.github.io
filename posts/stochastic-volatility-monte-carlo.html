---
layout: default
title: Heston
---

<style>

    .thumbnail {
      box-shadow: 0 5px 10px rgba(0,0,0,0.19), 0 3px 3px rgba(0,0,0,0.23);
    }
    .thumbnail:hover {
      box-shadow: 0 12px 24px rgba(0,0,0,0.19), 0 8px 8px rgba(0,0,0,0.23);
    }
  
    .fullCard {
      width: 750px;
      border: 1px solid #ccc;
      border-radius: 5px;
      margin: 10px 5px;
      padding: 4px;
  
    }
    .cardContent {
      padding: 10px;
  
    }
  
    .center {
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
  
</style>
  
  
  
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.1.0/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis@1.0.2/dist/tfjs-vis.umd.min.js"></script>
<script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
  
<!-- MathJax 
    and $\DeclareMathOperator*{\E}{\mathbb{E}} % expectation-type macro definitions-->
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
\(
    \def\E{\mathbb{E}}  % Expectation
    \def\P{\mathbb{P}}  % P probability measure
    \def\Q{\mathbb{Q}}  % Q probability measure
    \def\F{\mathcal{F}} % Filtration
    \def\d{\mathrm{d}}  % differential
\)


<!-- <div class="home"> -->

<!-- Thumbnails of blogposts: -->

<!-- #################################################################################### -->
<!-- Heston model blog -->
<div class="fullCard thumbnail" >
    <div class="cardContent">
  
        <h1 style="font-size:28px;">Heston Model: Stochastic Volatility</h1>
        <h2 style="font-size:20px;">A Monte Carlo Study</h2>
  
        <video width="300" height="auto" style="float: right; margin-left: 15px;" loop autoplay muted>
           <!-- <source src="../resources/posts/xxx/yyy.mp4" type="video/mp4"> -->
        </video>
  
        <br/>
        <br/>
        <span style="font-size:15px;">
            In this post we show how stochastic processes differ when the volatility of the process 
            is not constant but itself a Brownian motion. The stochastic volatility model is 
            fundamental in finance since
          <ul>
            <li>it is a way of relaxing the Black-Scholes model's constant volatility assumption</li>
            <li>accounts for a long observed tendency of the volatility of financial instruments (stocks or bonds) to move around its mean volatility</li>
            <li>can better reproduce option's implied volatility surface, i.e. smiles and smirks</li>
          </ul>
        </span>
  


        <h2>1. Introduction</h2>
        <p>
            This blog discusses how to price equity options via integrating 
            stochastic differential equations (SDE) using Monte Carlo (MC) 
            simulations through an example of the Heston model, a mean-reversion stochastic 
            volatility model. In this example we show how the machinery of SDEs, 
            their intergration over time and Monte Carlo simulations go together 
            to price equity options. We include several versions of the Python 
            code which show the setup using, in the simplest case, for-loops, 
            then vectorized versions in NumPy, and also using modern tensor 
            libraries, such as TensorFlow and PyTorch for the sake of coding 
            and speed comparisons.
        </p>
        
        <p>
            \[
                \begin{align} 
                \d S_t & = \sqrt{v_t} S_t \d B_t, \qquad S_0 > 0 \\
                \d v_t & = \kappa (\theta-r_t) \d t + \sigma\sqrt{v_t}(\rho \d B_t + \sqrt{1-\rho^2} \d W_t), \qquad v_0 > 0.
                \end{align}
            \]
        </p>

        <p>
            In these two coupled stochastic differential equations:
            <ul>
                <li>\(S_t\) is stock price process driven by the \(B_t\) Brownian motion, </li>
                <li>\(v_t\) is the volatility process driven by \(W_t\) Brownian motion 
                    ~~mixed with \(B_t\) so that the volatility is driven by a Brownian 
                    motion that has \(\rho\) correlation with \(B_t\). \(W_t\) is 
                    independent of \(B_t\)~~.
                </li>
            </ul>
        </p>

        <p>
            The stock price process is Generalized Geometric Brownian Motion 
            since the volatility is a stochastic process (instead of being 
            constant as in the Black-Scholes case).
        </p>
  
        <a class="pull-right" href="/posts/stochastic-volatility-monte-carlo.html" onMouseOver="document.readmore5.src='../resources/posts/buttons/button_read_more_push-min.png';" onMouseOut="document.readmore5.src='../resources/posts/buttons/button_read_more-min.png';">
        <img src="/resources/posts/buttons/button_read_more-min.png" name="readmore5" width=120px class="pull-right"></a>
        <!-- <a class="pull-right" href="https://arxiv.org/pdf/xxxx.xxxxx.pdf" onMouseOver="document.readpaper5.src='../resources/posts/buttons/button_read_paper_push-min.png';" onMouseOut="document.readpaper5.src='../resources/posts/buttons/button_read_paper-min.png';">
        <img src="../resources/posts/buttons/button_read_paper-min.png" name="readpaper5" width=120px class="pull-right"></a>
        <a class="pull-right" href="https://github.com/szalmaf/..." onMouseOver="document.viewcode5.src='../resources/posts/buttons/button_view_code_push-min.png';" onMouseOut="document.viewcode5.src='../resources/posts/buttons/button_view_code-min.png';">
        <img src="../resources/posts/buttons/button_view_code-min.png" name="viewcode5" width=120px></a> -->
  
        <span style="font-size:15px; text-align: right; float: right; color:gray">June 2019</span>
  
    </div>
</div>



<!-- #################################################################################### -->





</div> 
